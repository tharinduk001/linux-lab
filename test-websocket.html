<!DOCTYPE html>
<html>
  <head>
    <title>WebSocket Test</title>
  </head>
  <body>
    <h1>WebSocket Connection Test</h1>
    <div id="status">Connecting...</div>
    <div
      id="output"
      style="
        background: black;
        color: white;
        font-family: monospace;
        padding: 10px;
        height: 300px;
        overflow-y: auto;
      "
    ></div>
    <input type="text" id="command" placeholder="Enter command..." />
    <button onclick="sendCommand()">Send</button>

    <script>
      const ws = new WebSocket("ws://localhost:3001/terminal");
      const statusEl = document.getElementById("status");
      const outputEl = document.getElementById("output");
      const commandEl = document.getElementById("command");

      ws.onopen = () => {
        statusEl.textContent = "Connected to WebSocket server";
        statusEl.style.color = "green";
      };

      ws.onmessage = (event) => {
        outputEl.innerHTML += event.data.replace(/\n/g, "<br>");
        outputEl.scrollTop = outputEl.scrollHeight;
      };

      ws.onerror = (error) => {
        statusEl.textContent = "WebSocket error: " + error;
        statusEl.style.color = "red";
      };

      ws.onclose = () => {
        statusEl.textContent = "WebSocket connection closed";
        statusEl.style.color = "orange";
      };

      function sendCommand() {
        const command = commandEl.value;
        if (command && ws.readyState === WebSocket.OPEN) {
          ws.send(command + "\n");
          commandEl.value = "";
        }
      }

      commandEl.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          sendCommand();
        }
      });
    </script>
  </body>
</html>
